const content = {
  free: {
    src:
      'https://images.unsplash.com/photo-1550159930-40066082a4fc?auto=format&fit=crop&w=600&h=600&q=80',
    alt: 'corgi in the park with a sunset in the background',
    credit: 'Jacob Van Blarcom',
    creditLink: 'https://unsplash.com/photos/lkzjENdWgd8',
    message: 'To view this content, you need to create an account!',
    allowedRoles: ['free', 'pro', 'premium'],
  },
  other: {
    src:
      'data:image/jpeg;base64,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',
    alt: 'corgi in the park with a sunset in the background',
    credit: 'Jacob Van Blarcom',
    creditLink: 'https://unsplash.com/photos/lkzjENdWgd8',
    message: 'To view this content, you need to create an account!',
    allowedRoles: ['free', 'pro', 'premium'],
  },
  pro: {
    src:
      'https://images.unsplash.com/photo-1519098901909-b1553a1190af?auto=format&fit=crop&w=600&h=600&q=80',
    alt: 'close-up of a corgi with its tongue hanging out',
    credit: 'Florencia Potter',
    creditLink: 'https://unsplash.com/photos/yxmNWxi3wCo',
    message:
      'This is protected content! It’s only available if you have a pro plan or higher.',
    allowedRoles: ['pro', 'premium'],
  },
  premium: {
    src:
      'https://images.unsplash.com/photo-1546975490-e8b92a360b24?auto=format&fit=crop&w=600&h=600&q=80',
    alt: 'corgi in a tent with string lights in the foreground',
    credit: 'Cole Keister',
    creditLink: 'https://unsplash.com/photos/cX-KEISwDIw',
    message:
      'This is protected content! It’s only available if you have the premium plan.',
    allowedRoles: ['premium'],
  },
};

exports.handler = async (event, context) => {
  const { type } = JSON.parse(event.body);
  const { user } = context.clientContext;
  const roles = user ? user.app_metadata.roles : false;
  const { allowedRoles } = content[type];

  if (!roles || !roles.some((role) => allowedRoles.includes(role))) {
    return {
      statusCode: 402,
      body: JSON.stringify({
        src:
          'https://res.cloudinary.com/jlengstorf/image/upload/q_auto,f_auto/v1592618179/stripe-subscription/subscription-required.jpg',
        alt: 'corgi in a crossed circle with the text “subscription required”',
        credit: 'Jason Lengstorf',
        creditLink: 'https://dribbble.com/jlengstorf',
        message: `This content requires a ${type} subscription.`,
      }),
    };
  }

  return {
    statusCode: 200,
    body: JSON.stringify(content[type]),
  };
};
